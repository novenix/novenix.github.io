<!DOCTYPE html>

<html lang="es">

<head>

<meta charset="UTF-8">

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Spartan vs Elites: High Fidelity Pixels</title>

<style>

@import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');



body {

margin: 0;

padding: 0;

background-color: #121212;

display: flex;

justify_content: center;

align-items: center;

height: 100vh;

overflow: hidden;

font-family: 'Press Start 2P', cursive;

color: white;

}



#game-container {

position: relative;

box-shadow: 0 0 30px rgba(50, 150, 255, 0.3);

border: 4px solid #222;

}



canvas {

background: linear-gradient(to bottom, #1a0b2e, #4a69bd);

display: block;

/* CRUCIAL: Mantiene los píxeles nítidos */

image-rendering: pixelated;

}



#ui-layer {

position: absolute;

top: 10px;

left: 10px;

pointer-events: none;

text-shadow: 2px 2px 0 #000;

}



.bar-container {

margin-bottom: 5px;

border: 2px solid #000;

background: #333;

padding: 2px;

}



#hp-bar {

width: 200px;

height: 15px;

background-color: #555;

}



#hp-fill {

width: 100%;

height: 100%;

background-color: #3498db;

transition: width 0.1s linear;

}



#ammo-display { font-size: 12px; color: #f1c40f; margin-top: 8px; }



#reload-msg {

position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);

font-size: 20px; color: #e74c3c; display: none;

animation: blink 0.5s infinite; text-shadow: 2px 2px 0 #000; white-space: nowrap;

}



#game-over-screen {

position: absolute; top: 0; left: 0; width: 100%; height: 100%;

background: rgba(0, 0, 0, 0.9); display: none;

flex-direction: column; justify-content: center; align-items: center;

text-align: center; z-index: 10;

}



button {

background: #3498db; border: 4px solid #2980b9; color: white;

padding: 15px 30px; font-family: 'Press Start 2P', cursive; font-size: 14px;

cursor: pointer; margin-top: 25px; text-transform: uppercase;

}

button:hover { background: #2980b9; }



@keyframes blink { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }


#controls-hint {

position: absolute; bottom: 10px; left: 10px; font-size: 8px;

color: rgba(255,255,255,0.5); text-align: left; line-height: 1.5;

}

</style>

</head>

<body>

<div id="game-container">

<canvas id="gameCanvas" width="800" height="450"></canvas>

<div id="ui-layer">

<div class="bar-container"><div id="hp-bar"><div id="hp-fill"></div></div></div>

<div id="ammo-display">MUNICIÓN: <span id="ammo-count">30</span>/30</div>

<div id="score-display">PUNTOS: <span id="score-count">0</span></div>

</div>

<div id="reload-msg">¡PRESIONA 'R' PARA RECARGAR!</div>

<div id="game-over-screen">

<h1>FIN DEL JUEGO</h1>

<p>Puntaje: <span id="final-score">0</span></p>

<button onclick="resetGame()">JUGAR DE NUEVO</button>

</div>

<div id="controls-hint">MOVER: WASD/FLECHAS | SALTAR: W/ESPACIO | DISPARAR: K/CLICK | RECARGAR: R | AGACHARSE: S</div>

</div>



<script>

const canvas = document.getElementById('gameCanvas');

const ctx = canvas.getContext('2d');


// Elementos UI

const hpFill = document.getElementById('hp-fill');

const ammoCountSpan = document.getElementById('ammo-count');

const scoreSpan = document.getElementById('score-count');

const reloadMsg = document.getElementById('reload-msg');

const gameOverScreen = document.getElementById('game-over-screen');

const finalScoreSpan = document.getElementById('final-score');



// Configuración

const GRAVITY = 0.5; const FRICTION = 0.8; const FLOOR_Y = 400;

let gameRunning = true; let score = 0; let frame = 0;

const keys = { right: false, left: false, up: false, down: false, shoot: false, reload: false };



// --- CLASES ---

class Camera { constructor() { this.x = 0; } }

const camera = new Camera();



class Particle {

constructor(x, y, color, speed, sizeBase) {

this.x = x; this.y = y; this.color = color;

this.size = Math.random() * sizeBase + 2;

this.vx = (Math.random() - 0.5) * speed; this.vy = (Math.random() - 0.5) * speed;

this.life = 30 + Math.random() * 20;

}

update() {

this.x += this.vx; this.y += this.vy; this.vy += 0.1;

this.life--; this.size *= 0.95;

}

draw() { ctx.fillStyle = this.color; ctx.fillRect(this.x - camera.x, this.y, this.size, this.size); }

}



class Bullet {

constructor(x, y, dir, isPlayer) {

this.x = x; this.y = y; this.dir = dir; this.isPlayer = isPlayer;

this.w = isPlayer ? 10 : 8; this.h = isPlayer ? 4 : 6;

this.speed = isPlayer ? 12 : 8; this.markedForDeletion = false;

this.color = isPlayer ? '#f39c12' : '#e74c3c';

}

update() {

this.x += this.speed * this.dir;

if (this.x > camera.x + 900 || this.x < camera.x - 100) this.markedForDeletion = true;

}

draw() {

ctx.fillStyle = this.color; let drawX = this.x - camera.x;

if (this.isPlayer) {

ctx.fillRect(drawX, this.y, this.w, this.h);

ctx.fillStyle = '#fff'; ctx.fillRect(drawX + (this.dir > 0 ? this.w-2 : 0), this.y, 2, this.h);

} else {

ctx.beginPath(); ctx.arc(drawX + 4, this.y + 3, 4, 0, Math.PI*2); ctx.fill();

ctx.fillStyle = '#fff'; ctx.beginPath(); ctx.arc(drawX + 4, this.y + 3, 2, 0, Math.PI*2); ctx.fill();

}

}

}



class Player {

constructor() {

this.w = 36; this.h = 54; this.x = 100; this.y = FLOOR_Y - this.h;

this.vx = 0; this.vy = 0; this.speed = 5; this.jumpPower = -13;

this.grounded = false; this.facing = 1; this.crouching = false;

this.maxHp = 100; this.hp = this.maxHp; this.maxAmmo = 30; this.ammo = this.maxAmmo;

this.reloading = false; this.shootCooldown = 0; this.invulnerable = 0;

}



update() {

if (keys.right) { this.vx = this.speed; this.facing = 1; }

else if (keys.left) { this.vx = -this.speed; this.facing = -1; }

else { this.vx *= FRICTION; }


if (keys.down && this.grounded) {

this.crouching = true; this.h = 38; this.y = Math.min(this.y + 16, FLOOR_Y - this.h);

} else if (!keys.down && this.crouching) {

this.y -= 16; this.crouching = false; this.h = 54;

}



if (keys.up && this.grounded && !this.crouching) {

this.vy = this.jumpPower; this.grounded = false;

for(let i=0; i<5; i++) particles.push(new Particle(this.x+this.w/2, this.y+this.h, '#7f8c8d', 3, 4));

}



if (keys.shoot && this.shootCooldown <= 0 && this.ammo > 0 && !this.reloading) {

bullets.push(new Bullet(this.x + (this.facing===1?this.w:0), this.y + (this.crouching?14:20), this.facing, true));

this.ammo--; this.shootCooldown = 9; updateUI();

particles.push(new Particle(this.x + (this.facing===1?this.w:0), this.y + (this.crouching?14:20), '#f1c40f', 2, 6));

}



if (keys.reload && this.ammo < this.maxAmmo && !this.reloading) this.startReload();

reloadMsg.style.display = (this.ammo === 0 && !this.reloading) ? 'block' : 'none';



this.shootCooldown--; if(this.invulnerable > 0) this.invulnerable--;

this.vy += GRAVITY; this.x += this.vx; this.y += this.vy;



this.grounded = false;

if (this.y + this.h > FLOOR_Y) { this.y = FLOOR_Y - this.h; this.vy = 0; this.grounded = true; }

platforms.forEach(p => {

if (this.x < p.x + p.w - 5 && this.x + this.w > p.x + 5 &&

this.y + this.h >= p.y && this.y + this.h <= p.y + p.h && this.vy >= 0) {

this.y = p.y - this.h; this.vy = 0; this.grounded = true;

}

});

if (this.x < 0) this.x = 0;

}



startReload() {

this.reloading = true; ammoCountSpan.innerText = "---";

let reloadInterval = setInterval(() => {

if(!this.reloading) clearInterval(reloadInterval);

particles.push(new Particle(this.x + this.w/2, this.y, '#fff', 2, 3));

}, 200);

setTimeout(() => { this.ammo = this.maxAmmo; this.reloading = false; updateUI(); }, 1200);

}



takeDamage(amount) {

if (this.invulnerable > 0) return;

this.hp -= amount; this.invulnerable = 40; updateUI();

for(let i=0; i<10; i++) particles.push(new Particle(this.x + this.w/2, this.y + this.h/2, '#3498db', 8, 5));

if (this.hp <= 0) gameOver();

}



draw() {

if (this.invulnerable > 0 && frame % 4 < 2) return;

let drawX = this.x - camera.x;

ctx.save();

if (this.facing === -1) { ctx.translate(drawX + this.w, this.y); ctx.scale(-1, 1); drawX = 0; } else { ctx.translate(drawX, this.y); }



// --- DIBUJO DE ALTA FIDELIDAD DEL SPARTAN ---

const g_darkest = '#142814'; const g_dark = '#244024'; const g_mid = '#3a5e3a';

const g_light = '#577a57'; const g_highlight = '#7ba37b';

const metal = '#4a4a4a'; const black = '#111';

const visor_d = '#b06900'; const visor_l = '#e6a400';



// Traje interior negro (base)

ctx.fillStyle = black;

if(this.crouching) ctx.fillRect(6, 16, 24, 20); else ctx.fillRect(6, 14, 24, 38);



// PIERNAS DETALLADAS

if(!this.crouching) {

// Muslos

ctx.fillStyle = g_dark; ctx.fillRect(6, 36, 11, 12); ctx.fillRect(19, 36, 11, 12);

ctx.fillStyle = g_mid; ctx.fillRect(7, 37, 8, 10); ctx.fillRect(20, 37, 8, 10);

// Rodilleras

ctx.fillStyle = metal; ctx.fillRect(7, 47, 9, 4); ctx.fillRect(20, 47, 9, 4);

// Espinillas

ctx.fillStyle = g_dark; ctx.fillRect(6, 51, 10, 3); ctx.fillRect(20, 51, 10, 3);

ctx.fillStyle = g_mid; ctx.fillRect(7, 51, 8, 3); ctx.fillRect(21, 51, 8, 3);

}



// TORSO DETALLADO (Placas de armadura)

let torsoY = this.crouching ? 16 : 14;

ctx.fillStyle = g_dark; ctx.fillRect(4, torsoY, 28, this.crouching ? 16: 20);

// Placa pectoral

ctx.fillStyle = g_mid; ctx.fillRect(5, torsoY+2, 26, 10);

ctx.fillStyle = g_light; ctx.fillRect(7, torsoY+4, 10, 6); ctx.fillRect(19, torsoY+4, 10, 6);

ctx.fillStyle = g_highlight; ctx.fillRect(7, torsoY+4, 3, 3); ctx.fillRect(19, torsoY+4, 3, 3); // Brillos

// Zona abdominal

if(!this.crouching) { ctx.fillStyle = g_mid; ctx.fillRect(8, torsoY+14, 20, 6); }



// CASCO DETALLADO

let headY = this.crouching ? 2 : 0;

ctx.fillStyle = g_dark; ctx.fillRect(10, headY, 16, 14);

ctx.fillStyle = g_mid; ctx.fillRect(11, headY+1, 14, 10);

ctx.fillStyle = g_light; ctx.fillRect(12, headY+1, 12, 3); // Frente

ctx.fillStyle = metal; ctx.fillRect(13, headY+11, 10, 3); // Barbilla

// Visor complejo

ctx.fillStyle = visor_d; ctx.fillRect(11, headY+4, 14, 6);

ctx.fillStyle = visor_l; ctx.fillRect(12, headY+5, 12, 4);

ctx.fillStyle = '#fff'; ctx.fillRect(13, headY+6, 6, 2);



// BRAZOS Y ARMA

let armY = this.crouching ? 16 : 18;

let armX = this.crouching ? 18 : 22;

// Hombros (Pauldrons)

ctx.fillStyle = g_mid; ctx.fillRect(0, armY, 8, 8); ctx.fillRect(armX-2, armY, 8, 8);

ctx.fillStyle = g_highlight; ctx.fillRect(1, armY+1, 4, 4); ctx.fillRect(armX-1, armY+1, 4, 4);

// Brazos

ctx.fillStyle = g_dark; ctx.fillRect(1, armY+8, 6, 8); ctx.fillRect(armX, armY+8, 6, 8);



// RIFLE DE ASALTO DETALLADO

let gunX = this.crouching ? 14 : 18; let gunY = this.crouching ? 18 : 24;

ctx.fillStyle = '#333'; ctx.fillRect(gunX, gunY, 28, 9);

ctx.fillStyle = '#555'; ctx.fillRect(gunX+4, gunY+1, 20, 4); // Parte superior

ctx.fillStyle = '#222'; ctx.fillRect(gunX+16, gunY+6, 8, 4); // Cargador

ctx.fillStyle = '#777'; ctx.fillRect(gunX+28, gunY+3, 6, 3); // Cañón



ctx.restore();

}

}



class Enemy {

constructor(x, y) {

this.x = x; this.y = y; this.w = 42; this.h = 60;

this.hp = 40; this.vx = Math.random() > 0.5 ? -1.5 : 1.5;

this.patrolStart = x - 150; this.patrolEnd = x + 150;

this.cooldown = 0; this.markedForDeletion = false;

this.type = Math.random() > 0.5 ? 'blue' : 'red';

}



update(player) {

let dist = Math.sqrt(Math.pow(player.x - this.x, 2) + Math.pow(player.y - this.y, 2));

let canSee = dist < 450 && Math.abs(player.y - this.y) < 80;



if (canSee) {

if (player.x < this.x && this.vx > 0) this.vx *= -1;

if (player.x > this.x && this.vx < 0) this.vx *= -1;

if (this.cooldown <= 0) {

let dir = player.x < this.x ? -1 : 1;

bullets.push(new Bullet(this.x + (dir===1?this.w:0), this.y + 25, dir, false));

this.cooldown = 90 + Math.random() * 60;

particles.push(new Particle(this.x + (dir===1?this.w:0), this.y + 25, '#e74c3c', 2, 4));

}

} else {

this.x += this.vx;

if (this.x < this.patrolStart || this.x > this.patrolEnd) this.vx *= -1;

}

this.cooldown--;

}



draw() {

let drawX = this.x - camera.x;

if (drawX < -50 || drawX > canvas.width + 50) return;

ctx.save();

let facing = this.vx > 0 ? 1 : -1;

if (facing === -1) { ctx.translate(drawX + this.w, this.y); ctx.scale(-1, 1); drawX = 0; } else { ctx.translate(drawX, this.y); }



// --- PALETAS DE COLOR DE ALTA FIDELIDAD ---

let c_base, c_mid, c_light, c_eye;

const metal_d = '#5a6364'; const metal_l = '#bdc3c7'; const black = '#111';



if (this.type === 'blue') {

c_base = '#1a237e'; c_mid = '#283593'; c_light = '#3f51b5'; c_eye = '#8c9eff';

} else {

c_base = '#922b21'; c_mid = '#c0392b'; c_light = '#e74c3c'; c_eye = '#f1c40f';

}



// --- DIBUJO DEL ELITE CON POSTURA "DIGITÍGRADA" (Zig-Zag) ---


// Traje interior oscuro

ctx.fillStyle = black; ctx.fillRect(8, 16, 26, 24); // Torso base



// PIERNAS (Estructura compleja)

// Muslo (Hacia atrás)

ctx.fillStyle = c_base; ctx.fillRect(6, 38, 14, 12);

ctx.fillStyle = c_mid; ctx.fillRect(8, 40, 10, 8);

// Articulación rodilla inversa (Plateada)

ctx.fillStyle = metal_d; ctx.fillRect(4, 46, 8, 8);

// Espinilla (Hacia adelante)

ctx.fillStyle = c_base; ctx.fillRect(10, 50, 12, 10);

ctx.fillStyle = c_mid; ctx.fillRect(12, 52, 8, 6);

// Pie/Pezuña

ctx.fillStyle = metal_d; ctx.fillRect(10, 58, 14, 4);



// TORSO ENCORVADO Y ARMADURA

// Placa trasera grande (Plateada)

ctx.fillStyle = metal_d; ctx.fillRect(4, 14, 20, 18);

ctx.fillStyle = metal_l; ctx.fillRect(6, 16, 14, 10); // Brillo espalda

// Pechera de color

ctx.fillStyle = c_base; ctx.fillRect(24, 18, 12, 16);

ctx.fillStyle = c_mid; ctx.fillRect(26, 20, 8, 12);



// CABEZA ALARGADA

// Cuello

ctx.fillStyle = black; ctx.fillRect(18, 6, 12, 10);

// Cabeza superior de color

ctx.fillStyle = c_base; ctx.fillRect(20, 2, 20, 8);

ctx.fillStyle = c_mid; ctx.fillRect(22, 4, 16, 4);

// Mandíbulas/Lateral plateado

ctx.fillStyle = metal_d; ctx.fillRect(24, 8, 18, 8);

ctx.fillStyle = metal_l; ctx.fillRect(26, 10, 14, 4);

// Ojos brillantes

ctx.fillStyle = c_eye; ctx.fillRect(34, 6, 4, 3);

ctx.fillStyle = '#fff'; ctx.fillRect(35, 7, 2, 1);



// ARMA (RIFLE DE PLASMA CURVO)

let gunX = 20; let gunY = 30;

ctx.fillStyle = '#311b92'; // Morado oscuro base

// Forma curva superior

ctx.beginPath(); ctx.moveTo(gunX, gunY+10); ctx.quadraticCurveTo(gunX+10, gunY-5, gunX+30, gunY+5);

ctx.lineTo(gunX+28, gunY+12); ctx.quadraticCurveTo(gunX+10, gunY+5, gunX+2, gunY+14); ctx.fill();

// Núcleo de energía

ctx.fillStyle = '#b39ddb'; ctx.fillRect(gunX+12, gunY+2, 10, 6);

ctx.fillStyle = '#fff'; ctx.fillRect(gunX+14, gunY+4, 6, 2);



ctx.restore();

}

}



class Platform {

constructor(x, y, w, h) { this.x = x; this.y = y; this.w = w; this.h = h; }

draw() {

let drawX = this.x - camera.x; if (drawX + this.w < 0 || drawX > canvas.width) return;

ctx.fillStyle = '#3e4a5b'; ctx.fillRect(drawX, this.y, this.w, this.h);

ctx.strokeStyle = '#7f8c8d'; ctx.lineWidth = 3; ctx.strokeRect(drawX+1, this.y+1, this.w-2, this.h-2);

ctx.fillStyle = '#3498db'; for(let i=10; i<this.w; i+=40) ctx.fillRect(drawX + i, this.y + 8, 20, 4);

}

}



// --- INSTANCIAS GLOBALES ---

let player, bullets, particles, enemies, platforms;



function initLevel() {

player = new Player();

bullets = []; particles = []; enemies = []; platforms = [];

score = 0; camera.x = 0; gameRunning = true;

updateUI(); gameOverScreen.style.display = 'none';



platforms.push(new Platform(200, 320, 250, 25));

platforms.push(new Platform(550, 250, 200, 25));

platforms.push(new Platform(850, 180, 150, 25));

platforms.push(new Platform(1100, 280, 300, 25));

platforms.push(new Platform(1500, 350, 200, 25));



spawnEnemy(400, 320); spawnEnemy(700, FLOOR_Y); spawnEnemy(900, 180);

spawnEnemy(1200, 280); spawnEnemy(1600, 350); spawnEnemy(1800, FLOOR_Y);

}



function spawnEnemy(x, y) { enemies.push(new Enemy(x, y - 60)); }



// --- GAME LOOP ---

function update() {

if (!gameRunning) return;

player.update();

camera.x = player.x - 250; if (camera.x < 0) camera.x = 0;



bullets.forEach(b => {

b.update();

platforms.forEach(p => {

if (b.x > p.x && b.x < p.x + p.w && b.y > p.y && b.y < p.y+p.h) {

b.markedForDeletion = true;

for(let i=0; i<4; i++) particles.push(new Particle(b.x, b.y, '#bdc3c7', 4, 3));

}

});

if (b.y > FLOOR_Y) {

b.markedForDeletion = true;

for(let i=0; i<3; i++) particles.push(new Particle(b.x, b.y, '#555', 4, 3));

}



if (b.isPlayer) {

enemies.forEach(e => {

if (b.x>e.x && b.x<e.x+e.w && b.y>e.y && b.y<e.y+e.h) {

b.markedForDeletion = true; e.hp -= 15;

for(let i=0; i<6; i++) particles.push(new Particle(b.x, b.y, e.type === 'blue' ? '#5c6bc0' : '#e74c3c', 7, 5));

if (e.hp <= 0) {

e.markedForDeletion = true; score += (e.type === 'red' ? 150 : 100); updateUI();

for(let i=0; i<25; i++) particles.push(new Particle(e.x+e.w/2, e.y+e.h/2, e.type === 'blue' ? '#283593' : '#c0392b', 10, 8));

}

}

});

} else {

if (b.x>player.x && b.x<player.x+player.w && b.y>player.y && b.y<player.y+player.h) {

b.markedForDeletion = true; player.takeDamage(15);

}

}

});



bullets = bullets.filter(b => !b.markedForDeletion);

enemies = enemies.filter(e => !e.markedForDeletion);

particles.forEach((p, i) => { p.update(); if(p.life<=0) particles.splice(i,1); });


if (enemies.length < 3 && camera.x > 500) spawnEnemy(camera.x + 900 + Math.random()*200, FLOOR_Y);

enemies.forEach(e => e.update(player));

}



function draw() {

ctx.clearRect(0, 0, canvas.width, canvas.height);

let grd = ctx.createLinearGradient(0, 0, 0, canvas.height);

grd.addColorStop(0, "#1a0b2e"); grd.addColorStop(0.6, "#6a1b9a"); grd.addColorStop(1, "#e67e22");

ctx.fillStyle = grd; ctx.fillRect(0,0, canvas.width, canvas.height);



ctx.strokeStyle = 'rgba(255,255,255,0.1)'; ctx.lineWidth = 20;

ctx.beginPath(); ctx.arc(canvas.width/2, -600, 800, 0, Math.PI); ctx.stroke();



platforms.forEach(p => p.draw());

ctx.fillStyle = '#2c3e50'; ctx.fillRect(0, FLOOR_Y, canvas.width, canvas.height - FLOOR_Y);

ctx.fillStyle = '#1a252f'; ctx.fillRect(0, FLOOR_Y, canvas.width, 10);



enemies.forEach(e => e.draw());

player.draw();

bullets.forEach(b => b.draw());

particles.forEach(p => p.draw());

}



function loop() { update(); draw(); frame++; requestAnimationFrame(loop); }

function updateUI() {

hpFill.style.width = (player.hp / player.maxHp * 100) + '%';

ammoCountSpan.innerText = player.ammo; scoreSpan.innerText = score;

}

function gameOver() {

gameRunning = false; gameOverScreen.style.display = 'flex'; finalScoreSpan.innerText = score;

}

function resetGame() { initLevel(); }



const handleKey = (e, state) => {

const code = e.code;

if (code === 'ArrowRight' || code === 'KeyD') keys.right = state;

if (code === 'ArrowLeft' || code === 'KeyA') keys.left = state;

if (code === 'ArrowUp' || code === 'KeyW' || code === 'Space') keys.up = state;

if (code === 'ArrowDown' || code === 'KeyS') keys.down = state;

if (code === 'KeyK' || code === 'KeyF') keys.shoot = state;

if (code === 'KeyR') keys.reload = state;

}

window.addEventListener('keydown', e => handleKey(e, true));

window.addEventListener('keyup', e => handleKey(e, false));

canvas.addEventListener('mousedown', () => keys.shoot = true);

canvas.addEventListener('mouseup', () => keys.shoot = false);



initLevel();

loop();

</script>

</body>

</html>